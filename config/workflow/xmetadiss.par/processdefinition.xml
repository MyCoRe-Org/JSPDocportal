<?xml version="1.0" encoding="UTF-8"?>

<process-definition
  xmlns="urn:jbpm.org:jpdl-3.1"  name="xmetadiss">

  <!-- SWIMLANES (= process roles) -->

  <swimlane name="author" />
  
  <swimlane name="editor">
    <!--   <assignment expression="user(ernie)" /> -->
  </swimlane>
  
  <swimlane name="subjectExpert">
    <!--   <assignment expression="user(ernie)" /> -->
  </swimlane>  
  
  <start-state name="start">
     <transition name="go2processInitialized" to="processInitialized" />
  </start-state>

  <state name="processInitialized">
     <event type='node-enter'>
        <action class="org.mycore.frontend.workflowengine.jbpm.xmetadiss.MCRGetAuthorAction">
           <variableName>authorID</variableName>
        </action>
     </event>
     <transition name="go2authorCreated" to="authorCreated" />  
  </state>
  
  <state name="authorCreated">
     <event type='node-enter'>
        <action class="org.mycore.frontend.workflowengine.jbpm.xmetadiss.MCRGetURNAction">
           <variableName>reservatedURN</variableName>
        </action>        
     </event>  
  	<transition name="go2urnCreated" to="urnCreated" />
  </state>
  
  <state name="urnCreated">
  	<transition name="go2disshabCreated" to="disshabCreated" />
  </state>
  
  <state name="disshabCreated">
     <transition name="todo next" to="todonext" />
  </state>
  
  <state name="todonext">
    <transition to="end" />
  </state>
  
<!--   
  <task-node name="createMetadata">
    <task swimlane="author">
      <controller>
        <variable name="metadataFilename"/>
        <variable name="isMetadataCorrect" />
      </controller>
    </task>
    <transition name="ok" to="uploadFiles" />
    <transition name="correctMetadata" to="correctMetadata" />
  </task-node>  
  
  <task-node name="uploadFiles">
    <task swimlane="author">
      <controller>
        <variable name="derivateFilename"/>
      </controller>
    </task>
    <transition to="end" />
  </task-node>    
  
  <task-node name="correctMetadata">
    <task swimlane="author">
      <controller>
        <variable name="metadataFilename"/>
        <variable name="isMetadataCorrect" />
      </controller>
    </task>
    <transition name="ok" to="uploadFiles" />
  </task-node>   
-->
  <end-state name="end" />
  
</process-definition>